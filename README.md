# DDD Framework

Python é¢†åŸŸé©±åŠ¨è®¾è®¡ï¼ˆDDDï¼‰åŸºç¡€æ¡†æ¶ - å¼€ç®±å³ç”¨çš„ DDD æ¶æ„æ¨¡æ¿

## âœ¨ ç‰¹æ€§

- ğŸ—ï¸ **å®Œæ•´çš„ DDD åˆ†å±‚æ¶æ„**ï¼šDomainã€Applicationã€Infrastructure å±‚æ¸…æ™°åˆ†ç¦»
- ğŸ”„ **å¤šç¯å¢ƒè‡ªåŠ¨åˆ‡æ¢**ï¼štest/dev ç”¨ SQLiteï¼Œstaging/prod ç”¨ Supabaseï¼Œé›¶é…ç½®
- ğŸ’‰ **ä¾èµ–æ³¨å…¥å®¹å™¨**ï¼šåŸºäº dependency-injectorï¼Œç®¡ç†æ‰€æœ‰ä¾èµ–
- ğŸ§ª **æµ‹è¯•å‹å¥½**ï¼šæµ‹è¯•ç¯å¢ƒè‡ªåŠ¨ä½¿ç”¨ SQLite å†…å­˜æ•°æ®åº“ï¼Œè¶…å¿«é€Ÿ
- ğŸ”§ **é€šç”¨å·¥å…·é›†**ï¼š`common/` æ¨¡å—æä¾›å¸¸ç”¨å·¥å…·å‡½æ•°
- ğŸ“¦ **å¼€ç®±å³ç”¨**ï¼šå¤åˆ¶å³å¯ä½¿ç”¨ï¼Œé€‚åˆå¿«é€Ÿå¯åŠ¨æ–°é¡¹ç›®

---

## ğŸ“ é¡¹ç›®ç»“æ„

```
ddd-framework/
â”œâ”€â”€ domain/                      # ğŸ›ï¸ é¢†åŸŸå±‚ï¼ˆæ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼‰
â”‚   â””â”€â”€ common/                  # é¢†åŸŸåŸºç¡€ç±»
â”‚       â”œâ”€â”€ base_entity.py       # å®ä½“åŸºç±»
â”‚       â”œâ”€â”€ base_aggregate.py    # èšåˆæ ¹åŸºç±»
â”‚       â”œâ”€â”€ base_value_object.py # å€¼å¯¹è±¡åŸºç±»
â”‚       â”œâ”€â”€ base_event.py        # é¢†åŸŸäº‹ä»¶åŸºç±»
â”‚       â”œâ”€â”€ base_repository.py   # ä»“å‚¨æ¥å£åŸºç±»
â”‚       â”œâ”€â”€ specification.py     # è§„çº¦æ¨¡å¼
â”‚       â””â”€â”€ exceptions.py        # é¢†åŸŸå¼‚å¸¸
â”‚
â”œâ”€â”€ application/                 # ğŸ“¦ åº”ç”¨å±‚ï¼ˆç”¨ä¾‹ç¼–æ’ï¼‰
â”‚
â”œâ”€â”€ infrastructure/              # âš™ï¸ åŸºç¡€è®¾æ–½å±‚ï¼ˆæŠ€æœ¯å®ç°ï¼‰
â”‚   â”œâ”€â”€ database/                # æ•°æ®åº“
â”‚   â”‚   â”œâ”€â”€ database_factory.py  # â­ æ•°æ®åº“å·¥å‚ï¼ˆå¤šç¯å¢ƒè‡ªåŠ¨åˆ‡æ¢ï¼‰
â”‚   â”‚   â””â”€â”€ unit_of_work.py      # å·¥ä½œå•å…ƒæ¨¡å¼
â”‚   â”œâ”€â”€ config/                  # é…ç½®
â”‚   â”‚   â”œâ”€â”€ .env.example         # ç¯å¢ƒå˜é‡ç¤ºä¾‹
â”‚   â”‚   â””â”€â”€ settings.py          # é…ç½®ç±»
â”‚   â””â”€â”€ containers/              # ä¾èµ–æ³¨å…¥å®¹å™¨
â”‚       â””â”€â”€ app_containers.py    # â­ åº”ç”¨å®¹å™¨
â”‚
â”œâ”€â”€ common/                      # ğŸ”§ é€šç”¨å·¥å…·ï¼ˆè·¨å±‚ä½¿ç”¨ï¼‰
â”‚   â””â”€â”€ logging/                 # æ—¥å¿—æ¨¡å—
â”‚
â””â”€â”€ examples/                    # ğŸ“š ç¤ºä¾‹
```

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. å®‰è£…ä¾èµ–

```bash
pip install sqlalchemy pydantic-settings dependency-injector
```

### 2. è¿è¡Œç¤ºä¾‹

```bash
cd ddd-framework
python examples/basic_usage.py
```

---

## ğŸ“– æ ¸å¿ƒåŠŸèƒ½

### 1ï¸âƒ£ å¤šç¯å¢ƒæ•°æ®åº“è‡ªåŠ¨åˆ‡æ¢

æ¡†æ¶ä¼šæ ¹æ® `APP_ENV` ç¯å¢ƒå˜é‡**è‡ªåŠ¨é€‰æ‹©æ•°æ®åº“**ï¼š

| ç¯å¢ƒ | æ•°æ®åº“ | ç‰¹ç‚¹ |
|------|--------|------|
| **test** | SQLite å†…å­˜ | è¶…å¿«é€Ÿï¼Œç”¨äºæµ‹è¯• |
| **dev** | SQLite æ–‡ä»¶ | æŒä¹…åŒ–ï¼Œç”¨äºå¼€å‘ |
| **staging** | Supabase | é¢„å‘å¸ƒæµ‹è¯• |
| **prod** | Supabase | ç”Ÿäº§ç¯å¢ƒ |

```python
import os
from infrastructure.database import get_engine

# è®¾ç½®ç¯å¢ƒ
os.environ["APP_ENV"] = "dev"

# è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„æ•°æ®åº“ï¼
engine = get_engine()
```

---

### 2ï¸âƒ£ æ™ºèƒ½æ—¥å¿—ç³»ç»Ÿï¼ˆè‡ªåŠ¨ç¯å¢ƒé€‚é…ï¼‰

æ¡†æ¶ä¼š**æ ¹æ®ç¯å¢ƒè‡ªåŠ¨é€‰æ‹©æ—¥å¿—åç«¯**ï¼š

| ç¯å¢ƒ | æ—¥å¿—åç«¯ | ç‰¹ç‚¹ |
|------|----------|------|
| **test / dev** | Loguru | å½©è‰²è¾“å‡ºï¼Œæœ¬åœ°è°ƒè¯• |
| **staging / prod** | Logfire | äº‘ç«¯ç›‘æ§ï¼Œåˆ†å¸ƒå¼è¿½è¸ª |

**ä½¿ç”¨æ–¹å¼ï¼ˆé›¶é…ç½®ï¼‰**ï¼š

```python
import os
from common.logging import get_logger

# è®¾ç½®ç¯å¢ƒï¼ˆä»…æ­¤ä¸€æ¬¡ï¼‰
os.environ["APP_ENV"] = "dev"

# æ—¥å¿—è‡ªåŠ¨ä½¿ç”¨ Loguru âœ…
logger = get_logger(__name__)
logger.info("Hello, world!")
```

**è‡ªåŠ¨é€‚é…è§„åˆ™**ï¼š

```bash
# å¼€å‘/æµ‹è¯•ç¯å¢ƒ
export APP_ENV=dev
# â†’ è‡ªåŠ¨ä½¿ç”¨ Loguruï¼ˆæœ¬åœ°æ—¥å¿—ï¼‰

# ç”Ÿäº§ç¯å¢ƒ
export APP_ENV=prod
# â†’ è‡ªåŠ¨ä½¿ç”¨ Logfireï¼ˆäº‘ç«¯ç›‘æ§ï¼‰
```

**æ‰‹åŠ¨è¦†ç›–ï¼ˆå¯é€‰ï¼‰**ï¼š

```bash
# å¼ºåˆ¶ä½¿ç”¨ Loguruï¼ˆå³ä½¿åœ¨ç”Ÿäº§ç¯å¢ƒï¼‰
export APP_ENV=prod
export LOG_BACKEND=loguru  # æ‰‹åŠ¨è¦†ç›–
```

**ç”Ÿäº§ç¯å¢ƒå‡†å¤‡**ï¼š

```bash
# Logfire éœ€è¦è®¤è¯ï¼ˆä»…é¦–æ¬¡ï¼‰
pip install logfire
logfire auth
```

---

## ğŸ“„ è®¸å¯è¯

MIT License
